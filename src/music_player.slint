import { Button, VerticalBox, StandardTableView, ComboBox, ScrollView, LineEdit, ListView } from "std-widgets.slint";

struct TrackRowData {
    status: string,
    title: string,
    artist: string,
    album: string,
    selected: bool,
}

component ContextMenu inherits PopupWindow {
    callback rename();
    callback delete();
    in property <bool> is-playlist: false;
    width: 120px;
    height: is-playlist ? 56px : 32px;
    
    Rectangle {
        background: #333;
        border-width: 1px;
        border-color: #444;
        
        VerticalLayout {
            padding: 4px;
            spacing: 4px;
            Rectangle {
                height: 24px;
                background: item-ta-rename.has-hover ? #444 : transparent;
                border-radius: 2px;
                Text {
                    x: 8px;
                    text: "Rename";
                    color: #eee;
                    font-size: 13px;
                    vertical-alignment: center;
                }
                item-ta-rename := TouchArea {
                    clicked => {
                        root.rename();
                    }
                }
            }
            if is-playlist : Rectangle {
                height: 24px;
                background: item-ta-delete.has-hover ? #444 : transparent;
                border-radius: 2px;
                Text {
                    x: 8px;
                    text: "Delete";
                    color: #ff5555;
                    font-size: 13px;
                    vertical-alignment: center;
                }
                item-ta-delete := TouchArea {
                    clicked => {
                        root.delete();
                    }
                }
            }
        }
    }
}

component ConfirmationDialog inherits Rectangle {
    callback confirmed();
    callback cancelled();
    in property <string> message: "Are you sure?";
    in property <bool> is-visible: false;
    
    visible: is-visible;
    background: #00000080;
    
    // Prevent clicks from passing through
    TouchArea {}
    
    Rectangle {
        width: 350px;
        height: 150px;
        background: #282828;
        border-width: 1px;
        border-color: #444;
        border-radius: 4px;
        
        VerticalLayout {
            padding: 20px;
            spacing: 20px;
            
            Text {
                text: root.message;
                color: #eee;
                font-size: 14px;
                horizontal-alignment: center;
                wrap: word-wrap;
            }
            
            HorizontalLayout {
                spacing: 15px;
                alignment: center;
                
                Button {
                    text: "Cancel";
                    clicked => { root.cancelled(); }
                }
                
                Button {
                    text: "Delete";
                    primary: true;
                    clicked => { root.confirmed(); }
                }
            }
        }
    }
}

component PlaylistRow inherits Rectangle {
    in property <string> name;
    in property <bool> is-active;
    in property <bool> is-editing;
    callback clicked();
    callback renamed(string);
    callback context-menu-rename();
    callback context-menu-delete();
    callback cancel-edit();
    
    property <length> menu-x;
    property <length> menu-y;
    
    height: 24px;
    background: is-active ? #3d3d3d : ta.has-hover ? #333 : transparent;
    border-radius: 2px;
    
    if !is-editing : Text {
        x: 8px;
        text: root.name;
        color: is-active ? #eee : #aaa;
        font-size: 13px;
        vertical-alignment: center;
        horizontal-alignment: left;
    }
    
    if is-editing : LineEdit {
        x: 4px;
        width: parent.width - 8px;
        height: parent.height - 4px;
        text: root.name;
        accepted => {
            root.renamed(self.text);
        }
        init => {
            self.focus();
        }
    }
    
    ta := TouchArea {
        visible: !is-editing;
        clicked => { root.clicked(); }
        pointer-event(event) => {
            if (event.button == PointerEventButton.right && event.kind == PointerEventKind.down) {
                root.menu-x = self.mouse-x;
                root.menu-y = self.mouse-y;
                menu.show();
            }
        }
    }

    menu := ContextMenu {
        is-playlist: true;
        x: root.menu-x;
        y: root.menu-y;
        rename => {
            root.context-menu-rename();
        }
        delete => {
            root.context-menu-delete();
        }
    }

    FocusScope {
        visible: root.is-editing;
        key-pressed(event) => {
            if (event.text == Key.Escape) {
                root.cancel-edit();
                return accept;
            }
            reject
        }
    }
}

component TrackRow inherits Rectangle {
    in property <TrackRowData> data;
    in property <bool> is-playing;
    in property <bool> is-hover;

    height: 30px;
    background: data.selected ? #3d3d3d : is-hover ? #333 : transparent;
    animate background { duration: 100ms; }

    HorizontalLayout {
        padding-left: 8px;
        padding-right: 8px;
        spacing: 10px;

        Rectangle {
            width: 40px;
            Text {
                text: root.data.status;
                color: #2a6def;
                font-size: 14px;
                horizontal-alignment: center;
                vertical-alignment: center;
            }
        }

        Text {
            text: root.data.title;
            color: #eee;
            font-size: 13px;
            vertical-alignment: center;
            horizontal-stretch: 2;
            min-width: 150px;
            overflow: elide;
            horizontal-alignment: left;
        }

        Text {
            text: root.data.artist;
            color: #aaa;
            font-size: 13px;
            vertical-alignment: center;
            horizontal-stretch: 1;
            min-width: 100px;
            overflow: elide;
            horizontal-alignment: left;
        }

        Text {
            text: root.data.album;
            color: #888;
            font-size: 13px;
            vertical-alignment: center;
            horizontal-stretch: 1;
            min-width: 100px;
            overflow: elide;
            horizontal-alignment: left;
        }

        Rectangle {
            horizontal-stretch: 3;
        }
    }
}

component PlayerButton inherits Rectangle {
    width: 32px;
    height: 32px;
    background: touch-area.pressed ? #444 : touch-area.has-hover ? #666 : transparent;
    animate background { duration: 150ms; }
    in property <string> icon-text;
    in property <bool> enabled: true;
    in property <bool> is-primary: false;
    in property <length> font-size: 16px;
    callback clicked;
    Text {
        text: root.icon-text;
        font-size: root.font-size;
        color: root.is-primary ? #2a6def : #eee;
        horizontal-alignment: center;
        opacity: root.enabled ? 1.0 : 0.5;
    }

    touch-area := TouchArea {
        clicked => {
            if (root.enabled) {
                root.clicked();
            }
        }
    }
}

export component AppWindow inherits Window {
    preferred-width: 900px;
    preferred-height: 650px;
    min-width: 600px;
    min-height: 400px;
    title: "fooBar-like Music Player";
    background: #282828;

    key-handler := FocusScope {
        width: 0px;
        height: 0px;
        key-pressed(event) => {
            if (event.text == Key.Delete) {
                if (root.editing_playlist_index != -1 || root.show_confirm_dialog) {
                    return reject;
                }
                if (root.sidebar_has_focus) {
                    root.confirm_delete_playlist(root.active_playlist_index);
                } else {
                    root.delete_selected_tracks();
                }
                return accept;
            }
            if (event.text == Key.F2) {
                root.editing_playlist_index = root.active_playlist_index;
                return accept;
            }
            reject
        }
    }
    
    public function refocus_main() {
        key-handler.focus();
    }

    public function confirm_delete_playlist(index: int) {
        if (index >= 0 && index < root.playlists.length) {
            root.delete_target_index = index;
            root.delete_confirm_message = "Are you sure you want to delete the playlist '" + root.playlists[index].text + "'?";
            root.show_confirm_dialog = true;
        }
    }

    property <int> delete_target_index: -1;
    property <string> delete_confirm_message: "";
    in-out property <bool> show_confirm_dialog: false;
    in-out property <bool> sidebar_has_focus: false;

    // Status display at the bottom showing the currently playing track
    in-out property <string> status-text: "";

    VerticalLayout {
        // Toolbar with open and playback controls
        Rectangle {
            height: 42px;
            background: #202020;
            HorizontalLayout {
                padding-left: 12px;
                padding-right: 12px;
                padding-top: 8px;
                padding-bottom: 8px;
                spacing: 12px;
                
                // Left Group: Open
                Rectangle {
                    width: 70px;
                    height: 26px;
                    border-radius: 2px;
                    background: touch-area-open.pressed ? #444 : touch-area-open.has-hover ? #555 : #373737;
                    animate background { duration: 150ms; }
                    
                    Text {
                        text: "Open";
                        color: #eee;
                        font-size: 13px;
                        vertical-alignment: center;
                        horizontal-alignment: center;
                    }

                    touch-area-open := TouchArea {
                        clicked => {
                            root.open_file();
                        }
                    }
                }

                // Spacer 1
                Rectangle { horizontal-stretch: 1; }
                
                // Center Group: Playback controls
                HorizontalLayout {
                    spacing: 12px;
                    PlayerButton {
                        icon-text: "⏮";
                        font-size: 18px;
                        clicked => {
                            root.previous();
                        }
                    }

                    PlayerButton {
                        icon-text: "▶";
                        is-primary: true;
                        font-size: 20px;
                        clicked => {
                            root.play();
                        }
                    }

                    PlayerButton {
                        icon-text: "⏸";
                        font-size: 18px;
                        clicked => {
                            root.pause();
                        }
                    }

                    PlayerButton {
                        icon-text: "⏹";
                        font-size: 18px;
                        clicked => {
                            root.stop();
                        }
                    }

                    PlayerButton {
                        icon-text: "⏭";
                        font-size: 18px;
                        clicked => {
                            root.next();
                        }
                    }
                }

                // Spacer 2
                Rectangle { horizontal-stretch: 1; }
                
                // Right Group: Playback mode selection
                HorizontalLayout {
                    spacing: 12px;
                    
                    Text {
                        text: "Order:";
                        color: #888;
                        font-size: 13px;
                        vertical-alignment: center;
                    }

                    ComboBox {
                        width: 180px;
                        height: 26px;
                        model: ["Default", "Shuffle", "Random"];
                        current-index: root.playback_order_index;
                        selected => {
                            root.playback_order_changed(self.current-index);
                        }
                    }

                    Text {
                        text: "Repeat:";
                        color: #888;
                        font-size: 13px;
                        vertical-alignment: center;
                    }

                    Rectangle {
                        width: 32px;
                        height: 32px;
                        PlayerButton {
                            icon-text: "⟳";
                            font-size: 20px;
                            is-primary: root.repeat_mode != 0;
                            clicked => {
                                root.toggle_repeat();
                            }
                        }
                        if root.repeat_mode == 2 : Text {
                            text: "1";
                            color: #2a6def;
                            font-size: 6px;
                            font-weight: 700;
                            x: 13px;
                            y: 12px;
                        }
                    }

                    Text {
                        text: "Volume:";
                        color: #888;
                        font-size: 13px;
                        vertical-alignment: center;
                    }

                    volume-slider := Rectangle {
                        width: 110px;
                        height: 6px;
                        border-radius: 3px;
                        background: #333;

                        Rectangle {
                            x: 0;
                            y: 0;
                            width: volume-slider.width * root.volume-level;
                            height: parent.height;
                            background: #2a6def;
                            border-radius: 3px;
                        }

                        volume-handle := Rectangle {
                            width: 10px;
                            height: 10px;
                            x: (volume-slider.width * root.volume-level) - self.width / 2;
                            y: (parent.height - self.height) / 2;
                            background: white;
                            border-radius: 5px;
                            animate x {
                                duration: 100ms;
                                easing: ease-out;
                            }
                        }

                        states [
                            hover when ta-volume.has-hover || ta-volume.pressed: {
                                volume-handle.width: 12px;
                                volume-handle.height: 12px;
                            }
                        ]

                        ta-volume := TouchArea {
                            width: parent.width;
                            height: 20px;
                            mouse-cursor: pointer;
                            clicked => {
                                root.volume-level = max(0, min(1, self.mouse-x / volume-slider.width));
                                root.volume-changed(root.volume-level);
                            }
                            moved => {
                                if (self.pressed) {
                                    root.volume-level = max(0, min(1, self.mouse-x / volume-slider.width));
                                    root.volume-changed(root.volume-level);
                                }
                            }
                        }
                    }

                    Text {
                        width: 34px;
                        text: floor(root.volume-level * 100) + "%";
                        color: #888;
                        font-size: 12px;
                        vertical-alignment: center;
                        horizontal-alignment: right;
                    }
                }
            }
        }
        
        // Progress bar section
        Rectangle {
            height: 32px;
            background: #242424;
            HorizontalLayout {
                padding-left: 12px;
                padding-right: 12px;
                padding-top: 8px;
                padding-bottom: 8px;
                spacing: 10px;
                
                // Current time display
                Text {
                    text: root.format-time(root.elapsed-ms);
                    color: #888;
                    font-size: 12px;
                    vertical-alignment: center;
                    horizontal-alignment: right;
                    width: 45px;
                }
                
                // Improved interactive seek bar
                seekbar := Rectangle {
                    height: 6px;
                    border-radius: 3px;
                    background: #333;
                    horizontal-stretch: 1;
                    
                    // Progress indicator
                    Rectangle {
                        x: 0;
                        y: 0;
                        width: seekbar.width * root.position-percentage;
                        height: parent.height;
                        background: #2a6def;
                        border-radius: 3px;
                        animate width {
                            duration: 150ms;
                            easing: ease-out;
                        }
                    }
                    
                    // Handle over the progress bar
                    handle := Rectangle {
                        width: 12px;
                        height: 12px;
                        x: (seekbar.width * root.position-percentage) - self.width / 2;
                        y: (parent.height - self.height) / 2;
                        background: white;
                        border-radius: 6px;
                        drop-shadow-offset-y: 1px;
                        drop-shadow-blur: 2px;
                        drop-shadow-color: #00000080;
                        
                        // Smooth animation for handle position updates
                        animate x {
                            duration: 150ms;
                            easing: ease-out;
                        }
                    }
                    
                    // Focus highlighting when hovering
                    states [
                        hover when ta-seek.has-hover || ta-seek.pressed: {
                            handle.background: #ffffff;
                            handle.width: 14px;
                            handle.height: 14px;
                        }
                    ]
                    
                    // Simple touch area for seeking
                    ta-seek := TouchArea {
                        width: parent.width;
                        height: 20px; 
                        mouse-cursor: pointer;
                        clicked => {
                            root.seek-to(max(0, min(1, self.mouse-x / seekbar.width)));
                        }
                        moved => {
                            if (self.pressed) {
                                root.seek-to(max(0, min(1, self.mouse-x / seekbar.width)));
                            }
                        }
                    }
                }
                
                // Total duration display
                Text {
                    text: root.format-time(root.total-ms);
                    color: #888;
                    font-size: 12px;
                    vertical-alignment: center;
                    width: 45px;
                }
            }
        }
        
        // Main content: Sidebar and Playlist
        HorizontalLayout {
            vertical-stretch: 1;
            
            // Left Sidebar
            Rectangle {
                horizontal-stretch: 1;
                min-width: 150px;
                max-width: 250px;
                background: #202020;
                
                sidebar-ta := TouchArea {
                    clicked => {
                        root.sidebar_has_focus = true;
                        root.refocus_main();
                    }
                }

                VerticalLayout {
                    // Top Half: Playlist Picker
                    VerticalLayout {
                        vertical-stretch: 1;
                        padding: 8px;
                        spacing: 4px;
                        
                        HorizontalLayout {
                            Text {
                                text: "Playlists";
                                color: #888;
                                font-size: 12px;
                                font-weight: 700;
                                vertical-alignment: center;
                            }
                            Rectangle { horizontal-stretch: 1; }
                            PlayerButton {
                                icon-text: "+";
                                font-size: 18px;
                                clicked => { root.create_playlist(); }
                            }
                        }
                        
                        Rectangle { height: 1px; background: #333; }
                        
                        ScrollView {
                            vertical-stretch: 1;
                            VerticalLayout {
                                alignment: start;
                                for p[i] in root.playlists : PlaylistRow {
                                    name: p.text;
                                    is-active: root.active_playlist_index == i;
                                    is-editing: root.editing_playlist_index == i;
                                    clicked => { 
                                        root.switch_playlist(i); 
                                        root.editing_playlist_index = -1;
                                        root.sidebar_has_focus = true;
                                        root.refocus_main();
                                    }
                                    renamed(new-name) => {
                                        root.rename_playlist(i, new-name);
                                        root.editing_playlist_index = -1;
                                        root.refocus_main();
                                    }
                                    cancel-edit() => {
                                        root.editing_playlist_index = -1;
                                        root.refocus_main();
                                    }
                                    context-menu-rename() => {
                                        root.editing_playlist_index = i;
                                    }
                                    context-menu-delete() => {
                                        root.confirm_delete_playlist(i);
                                    }
                                }
                            }
                        }
                    }
                    
                    // Bottom Half: Metadata and Album Art
                    VerticalLayout {
                        vertical-stretch: 1;
                        padding: 10px;
                        alignment: end;
                        spacing: 10px;
                        
                        // Metadata display
                        VerticalLayout {
                            spacing: 4px;
                            if root.display_title != "" : Text {
                                text: root.display_title;
                                color: #eee;
                                font-size: 14px;
                                font-weight: 700;
                                wrap: word-wrap;
                                overflow: elide;
                            }
                            if root.display_artist != "" : Text {
                                text: root.display_artist;
                                color: #ccc;
                                font-size: 13px;
                                wrap: word-wrap;
                                overflow: elide;
                            }
                            if root.display_album != "" : Text {
                                text: root.display_album;
                                color: #aaa;
                                font-size: 12px;
                                wrap: word-wrap;
                                overflow: elide;
                            }
                            HorizontalLayout {
                                spacing: 8px;
                                if root.display_date != "" : Text {
                                    text: root.display_date;
                                    color: #888;
                                    font-size: 11px;
                                }
                                if root.display_genre != "" : Text {
                                    text: root.display_genre;
                                    color: #888;
                                    font-size: 11px;
                                    horizontal-stretch: 1;
                                    overflow: elide;
                                }
                            }
                        }
                        
                        Rectangle {
                            height: self.width;
                            background: #202020;
                            border-radius: 4px;
                            
                            Image {
                                source: root.current_cover_art;
                                width: parent.width;
                                height: parent.height;
                                image-fit: contain;
                            }
                        }
                    }
                }
            }

            Rectangle {
                horizontal-stretch: 4;
                background: #282828;
                
                TouchArea {
                    clicked => {
                        root.sidebar_has_focus = false;
                        root.refocus_main();
                    }
                }

                VerticalLayout {
                    // Header
                    Rectangle {
                        height: 28px;
                        background: #202020;
                        HorizontalLayout {
                            padding-left: 8px;
                            padding-right: 8px;
                            spacing: 10px;
                            Rectangle { width: 40px; Text { text: "#"; color: #555; font-size: 11px; horizontal-alignment: center; vertical-alignment: center; } }
                            Text { text: "Title"; color: #888; font-size: 12px; horizontal-stretch: 2; min-width: 150px; vertical-alignment: center; horizontal-alignment: left; }
                            Text { text: "Artist"; color: #888; font-size: 12px; horizontal-stretch: 1; min-width: 100px; vertical-alignment: center; horizontal-alignment: left; }
                            Text { text: "Album"; color: #888; font-size: 12px; horizontal-stretch: 1; min-width: 100px; vertical-alignment: center; horizontal-alignment: left; }
                            Rectangle { horizontal-stretch: 3; }
                        }
                    }

                    track-list-container := Rectangle {
                        clip: true;

                        track-list := ListView {
                            property <length> row-height: 30px;
                            property <length> header-height: 28px;

                            for track[i] in root.track_model : TrackRow {
                                data: track;
                                is-playing: root.playing_track_index == i;
                                is-hover: root.hover-index == i && !root.is-dragging;
                            }
                        }

                        track-list-overlay := TouchArea {
                            x: 0;
                            y: 0;
                            width: parent.width;
                            height: parent.height;

                            property <length> row-height: 30px;
                            property <length> header-height: 28px;
                            property <length> content-y: self.mouse-y - track-list.viewport-y;
                            property <int> hovered-row: max(-1, min(root.track_model.length - 1, floor(content-y / row-height)));
                            property <int> drop-gap: max(0, min(root.track_model.length, floor((content-y + row-height / 2) / row-height)));

                            pointer-event(event) => {
                                if (event.button == PointerEventButton.left) {
                                    if (self.hovered-row < 0) {
                                        return;
                                    }
                                    if (event.kind == PointerEventKind.down) {
                                        root.pressed-index = self.hovered-row;
                                        root.press-y = self.mouse-y;
                                        root.sidebar-has-focus = false;
                                        key-handler.focus();
                                        root.on_pointer_down(self.hovered-row, event.modifiers.control, event.modifiers.shift);
                                    } else if (event.kind == PointerEventKind.up) {
                                        root.on_drag_end(self.drop-gap);
                                        root.hover-index = -1;
                                    }
                                }
                            }

                            moved => {
                                if (!self.pressed) {
                                    root.hover-index = self.hovered-row;
                                } else {
                                    if (!root.is-dragging && abs(self.mouse-y - root.press-y) > 5px) {
                                        root.is-dragging = true;
                                        root.on_drag_start(root.pressed-index);
                                    }
                                    if (root.is-dragging) {
                                        root.on_drag_move(self.drop-gap);
                                    }
                                }
                            }

                            double-clicked => {
                                root.playlist_item_double_click(self.hovered-row);
                            }
                        }

                        // Visual Drop Indicator
                        if (root.is-dragging && root.drop-index != -1) : Rectangle {
                            x: 0;
                            y: max(0 , track-list.header-height + (root.drop-index - 1) * 30px) + track-list.viewport-y;
                            width: 100%;
                            height: 2px;
                            background: #2a6def;
                        }
                    }
                }
            }
        }

        // Status bar
        Rectangle {
            height: 24px;
            background: #1a1a1a;
            HorizontalLayout {
                padding-left: 12px;
                padding-right: 12px;
                spacing: 15px;
                
                Text {
                    text: root.status-text == "" ? "" : "Now Playing: " + root.status-text;
                    color: #aaa;
                    font-size: 12px;
                    vertical-alignment: center;
                    overflow: elide;
                    horizontal-stretch: 1;
                }
                
                // Technical info area
                Rectangle { horizontal-stretch: 1; }
                
                Text {
                    text: root.technical-info;
                    color: #777;
                    font-size: 11px;
                    vertical-alignment: center;
                    overflow: elide;
                }
                
                VerticalLayout {
                    alignment: center;
                    Rectangle { width: 1px; background: #333; height: 12px; }
                }
                
                Text {
                    text: root.format-time-range(root.elapsed-ms, root.total-ms);
                    color: #999;
                    font-size: 12px;
                    vertical-alignment: center;
                    width: 100px;
                    horizontal-alignment: right;
                }
            }
        }
    }

    // Modal overlay for confirmation
    confirm_overlay := ConfirmationDialog {
        is-visible: root.show_confirm_dialog;
        message: root.delete_confirm_message;
        confirmed => {
            root.delete_playlist(root.delete_target_index);
            root.show_confirm_dialog = false;
            root.refocus_main();
        }
        cancelled => {
            root.show_confirm_dialog = false;
            root.refocus_main();
        }
    }

    // Properties to communicate with Rust
    in-out property <[StandardListViewItem]> playlists: [];
    in-out property <int> active_playlist_index: 0;
    in-out property <int> editing_playlist_index: -1;
    in-out property <[TrackRowData]> track_model: [];
    in-out property <int> playback_order_index: 0;
    in-out property <int> repeat_mode: 0; // 0: Off, 1: Playlist, 2: Track
    in-out property <int> selected_track_index: -1;
    in-out property <int> playing_track_index: -1;

    // Album art properties
    in-out property <bool> show_album_art: true;
    in-out property <image> current_cover_art;

    // Metadata display properties
    in-out property <string> display_title: "";
    in-out property <string> display_artist: "";
    in-out property <string> display_album: "";
    in-out property <string> display_date: "";
    in-out property <string> display_genre: "";

    // Drag and drop state
    in-out property <int> pressed-index: -1;
    property <length> press-y: 0;
    in-out property <bool> is-dragging: false;
    in-out property <int> drop-index: -1;
    property <int> hover-index: -1;

    // Seek bar properties - raw integer values from Rust (no string allocations)
    in-out property <int> elapsed-ms: 0;
    in-out property <int> total-ms: 0;
    in-out property <float> position-percentage: 0.0; // between 0.0 and 1.0
    in-out property <float> volume-level: 1.0; // between 0.0 and 1.0
    in-out property <string> technical-info: "";
    
    // Computed time display strings (derived from integer ms values)
    // These are computed in Slint to avoid Rust string allocations
    pure function format-time-component(value: int) -> string {
        if value < 10 {
            return "0" + value;
        }
        return value;
    }
    
    pure function format-time(ms: int) -> string {
        if ms <= 0 {
            return "0:00";
        }
        return floor(ms / 60000) + ":" + root.format-time-component(mod(floor(ms / 1000), 60));
    }
    
    pure function format-time-range(elapsed: int, total: int) -> string {
        return root.format-time(elapsed) + " / " + root.format-time(total);
    }

    // Callback declarations
    callback open_file();
    callback play();
    callback pause();
    callback stop();
    callback next();
    callback previous();
    callback handle_track_click(int, bool, bool);
    callback on_pointer_down(int, bool, bool);
    callback on_drag_start(int);
    callback on_drag_move(int);
    callback on_drag_end(int);
    callback playlist_item_double_click(int);
    callback playback_order_changed(int);
    callback toggle_repeat();
    callback seek-to(float); // Position between 0.0 and 1.0
    callback volume-changed(float); // Volume between 0.0 and 1.0
    callback delete_selected_tracks();
    callback reorder_tracks([int], int); // indices, to
    callback deselect_all();
    callback create_playlist();
    callback switch_playlist(int);
    callback rename_playlist(int, string);
    callback delete_playlist(int);
}
