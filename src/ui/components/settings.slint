import { ComboBox, LineEdit } from "std-widgets.slint";

export component SettingsDropdownControl inherits Rectangle {
    in property <string> label;
    in property <[string]> options;
    in-out property <int> selected_index;
    in-out property <string> custom_value;
    in property <string> custom_placeholder;
    in property <length> label_width: 170px;
    in property <length> control_min_width: 200px;
    in property <length> control_max_width: 320px;
    in property <length> control_height: 32px;

    property <length> control_width: min(
        root.control_max_width,
        max(root.control_min_width, root.width - root.label_width - 16px)
    );
    property <bool> use_custom: root.options.length > 0 && root.selected_index == root.options.length - 1;
    height: root.use_custom ? root.control_height * 2 + 14px : root.control_height + 6px;

    VerticalLayout {
        spacing: 6px;

        HorizontalLayout {
            spacing: 10px;

            Text {
                text: root.label;
                color: #ddd;
                font-size: 12px;
                width: root.label_width;
                vertical-alignment: center;
                horizontal-alignment: left;
            }

            Rectangle {
                width: root.control_width;
                height: root.control_height;
                background: transparent;
                ComboBox {
                    width: parent.width;
                    height: parent.height;
                    model: root.options;
                    current-index <=> root.selected_index;
                }
            }
            Rectangle { horizontal-stretch: 1; }
        }

        if root.use_custom : HorizontalLayout {
            spacing: 10px;
            Rectangle {
                width: root.label_width;
            }
            LineEdit {
                width: root.control_width;
                height: root.control_height;
                text <=> root.custom_value;
                placeholder-text: root.custom_placeholder;
            }
            Rectangle { horizontal-stretch: 1; }
        }
    }
}
